<!DOCTYPE html>

<head>
    <link rel="stylesheet" type="text/css" href="/ssp_new/themes/default/css/reset.css" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    .body{
    	width:800px;
    	margin:0 auto;
    }

	.region-select{
		overflow: hidden;
	}
	.selected-list{
		width:45%;
		height: 160px;
		border:1px solid;
		float:left;
	}
	.selected-item{
		
	}

	.selected-item  li {
		overflow: hidden;
		width:40%;

	}
	.selected-item > li > span {
		float:left;
		display:block;
		margin:2px;
	}
	.selected-subItem{
		overflow: hidden;
	}
	.selected-subItem li{
		width:auto;
		float: left;
		margin:2px;
	}

	.region-list{
		width:54%;
		float:right;
	}
	.region-items{
/* 		overflow: hidden;
	 */	}
	.region-items > li{
		float:left;

	}

	.region-items button{
		width:18px;
		height: 18px;
	}

	.region-subItems {

		position: relative;
		
	}

	.region-subItems ul{
		position: absolute;
		border:  1px solid;
		z-index: 100;
		padding:5px;
		width:200px;
		background: #fff;
	}

	.region-subItems li{
		float:left;
		padding:2px 2px;
		width:80px;

	}

    </style>
    <script src="http://localhost/ssp_new2/js/libs/knockout-2.2.1.js"></script>
    <script src="http://localhost/ssp_new2/js/libs/knockout.mapping.min.js"></script>
    <script src="http://localhost/ssp_new2/assets/c0937cae/jquery.js"></script>


</head>
<body>
<script src="city.js"></script>


<div id="cityContainer">
	<ul data-bind="foreach:$data">
		<li>
			<label><input type="checkbox" value="value:code"><span data-bind="text:name"></span></label>
			<!--ko if:chidren-->
			<ul>
				<li>
					
				</li>
			</ul>
			<!--/ko-->
		</li>
	</ul>
</div>

<script>
;(function(){
	var _xtree = function(name){
		this.name = name;
	}
	_xtree.prototype ={
		init:function(datas){
			return this.setVm(datas,function(item,isChild){
				if(isChild)
				{
						item.selectedItems = ko.observableArray([]);
				}

				item.selectedState = ko.observable(0);
			});
		},
		/** [setVm description]
		 *  setFunc(data,isChild)	
		 */
		setVm:function(data,setFunc){
			var self = this;
			ko.utils.arrayForEach(data,(function(self){

					return function(item){

						if('children' in item)
						{
							setFunc(item,true);
							self.setVm(item.children,setFunc);
						}
						else{
							setFunc(item,false);
						}
				}
			})(self));

			data.getSelectItems =function(){
				var selectedItems = [];
				ko.utils.arrayForEach(data,(function(self){
					return function(item){
						if('selectedItems' in item){
							selectedItems.push(item.selectedItems());
						}else if(item.level==1){
							setSelectItems.push(item.code);
						}
					}
				})(data));
				return selectedItems;
			};

			data.setSelectItems = function(){}
			
			return data;
		}

	}

	var tree = new _xtree();
	var cityVm = tree.init(cityData.data.helper,[]);
	console.log('cityData',document.getElementById('cityContainer'));
	ko.applyBindings(cityVm);
})();


</script>
</body>
</html>